[toc]

这是一个简易的作业整理脚本，编写的目的是解放学委的双眼和双手。只需进行少许设置即可完成不同学科、不同学生群体、不同作业类型的作业整理与统计。

# 使用环境

1. python 3.7.8
2. openpyxl （Python 与 Excel 交互）
3. wxpython （GUI界面设计）

# 使用说明

1. 将记录学生信息（学号、姓名）的xlsx表格放在`datas`文件夹中。注意，学生信息所在的工作表的表名为`Sheet1`

| 学号     | 姓名 | 第1次 | ……   |
| -------- | ---- | :---- | ---- |
| 40408001 | 张三 |       |      |
| 40408002 | 李四 |       |      |
| 40408003 | 赵五 |       |      |
| ……       | ……   |       |      |

2. 将待整理的作业保存在`unsort`文件夹中。注意待整理的作业需要包含学号的信息、正确的文件格式才能正确被处理。

3. 配置`settings.txt`，可以直接修改`settings.txt`，也可以运行`python frameMain.py`进行设置。

   `EXCEL_PATH`：xlsx表格所在的路径

   `UNSORT_PATH`：待整理文件夹的路径

   `SORTED_PATH`：整理好的作业的输出文件夹路径

   `LOG_PATH`：日志的输出路径（此项可以设置为auto）

   `HW_ID`：表示第几次作业，用阿拉伯数字

   `HW_NAME`：作业科目的名称

   `HW_TYPE`：作业的类型，目前有两个可选值 “作业”, “实验”

   `HW_FORMAT`：作业提交格式，如“.pdf”，“.doc”等，可以填写多个提交格式，以英文逗号隔开","

   `HW_NOTE`：作业内容，可以不写

   `HW_COUNT`：预计需收的作业份数，目的是为了核对表格的学生个数，如果不等发出警告（仅此而已）

   `IDREGEX`：学号的正则表达式，如`40408\d\d\d`，用于从待整理的作业提取出学生的学号信息

   `HW_FORMAT`：作业的命名格式，设置了”转义“功能，支持以下的”转义“：

   - `[hwID]` 作业的次数，用阿拉伯数字

   - `[hwName]` 作业科目的名称

   - `[hwType]` 作业的类型

   - `[hwFormat]` 该作业合法的提交格式

   - `[stuName]` 该作业的学生姓名

   - `[stuID]` 该作业的学生学号

     > **例子**：
     >
     > `[stuID][stuName][hwFormat]`转义为`40408001张三.pdf`
     >
     > `[stuID]_[stuName]_[hwName]第[hwID]次[hwType][hwFormat]`转义为`40408001_张三_信号与系统第1次作业.pdf`

4. 运行`python main.py`，可以尝试输入命令
   - `quit`：退出程序
   - `sort`：整理`unsort`中的作业
   - `print unfinish`：显示未交作业的同学信息
   - `print finish`：显示已交作业的同学信息
   - `print all`：显示所有同学的提交信息
   - `print settings`：显示设置信息
   - `print menu`：显示菜单
   - `clear`：清屏

# 其他说明

1. 已交作业的同学会在表格对应位置上填写完成整理的时间
2. 日志文件夹`log`中的子文件夹表示作业次数，其中存放每一次整理的日志信息（存放未交作业同学的信息）